# Bomberman 红白机(NES) 经典复刻 TODO List (No Props, Simple Enemies Version)

## 项目现状与 NES 差异分析

为了复刻 FC/NES 版本的《炸弹人》核心玩法，并简化开发流程，目前规划如下：

- **核心玩法**：炸墙 -> 找门 -> 进门。
- **敌人**：暂无敌人（阶段一），阶段二只实现一种简单敌人。
- **无道具**：玩家初始属性增强，无需拾取道具。
- **门机制**：门被炸不会出怪（因为无敌人），也不会被销毁。

---

## 第一阶段：地图与通关（**优先级：最高**）

确立“炸墙 -> 找门 -> 进门”的最小闭环。

### 1.0 核心规则定义（胜负判定）

**模式修正：PvP 大逃杀 + 终点机制**
游戏依然保持多人对战（PvP）的基础，但单纯“活到最后”不再直接获胜，必须进入“门”才算真正的胜利。

- **失败条件（Game Over）**：
  - 玩家死亡即个人失败。
- **胜利条件（Winner）**：
  - **条件 A**：场上**只剩一名玩家**（单人模式默认满足）。
  - **条件 B**：该幸存玩家移动到**门（TileDoor）**的坐标上。
  - **Stage 2 附加条件**：如果加入了敌人，可能还需要先清空敌人（视后续设计而定，目前保持 Stage 1 简单化）。
- **代码改造点**：
  - 修改 `IsGameOver()`：不仅检查 `aliveCount == 1`，还要检查该玩家是否站在门上。
  - (可选) 如果最后一人还没进门就被炸死了（同归于尽），则平局（无人胜利）。

### 1.1 完善地图元素

**依赖关系**：无  
**预期时间**：2 小时

#### 任务分解：

- [ ] 1.1.1 定义核心 Tile 类型
  - 在 `pkg/core/map.go` 更新 `TileType`：
    - `TileDoor`（门）
- [ ] 1.1.2 隐藏门机制

  - 在 `GameMap` 中维护 `HiddenDoorPos struct{X, Y int}`。
  - 只有在该坐标的 `TileBrick` 被炸毁时，将该位置的 Tile 更新为 `TileDoor`。

- [ ] 1.1.3 核心交互逻辑
  - **火焰 vs 门**：
    - 在 `createExplosion` 中，如果火焰覆盖了 `TileDoor`，什么都不发生（门是无敌的）。
  - **玩家 vs 门**：
    - 玩家可以走到门上。

### 1.2 通关判定

**依赖关系**：依赖 1.1  
**预期时间**：1-2 小时

#### 任务分解：

- [ ] 1.2.1 门的功能实现
  - 修改 `CheckLevelCompletion`：
    - 条件 A：玩家与门重合。
    - 条件 B：由于暂时没有敌人，直接通关。
    - 触发 `LevelComplete` 状态。

---

## 第二阶段：基础敌人系统（**优先级：高**）

实现唯一的敌人类型，增加通过阻碍。

### 2.1 简单敌人框架

**依赖关系**：无  
**预期时间**：2-3 小时

#### 任务分解：

- [ ] 2.1.1 敌人基础结构 `Ghost`

  - 简化版字段：只是位置、速度、方向和是否存活。只有一种类型：**Balloom (气球)**。

- [ ] 2.1.2 简单 AI (随机移动)
  - 实现 `Update`：
    - 沿当前方向移动。
    - 碰到墙壁或砖块：随机转向（Simple Collision Avoidance）。
    - 速度：慢（便于躲避）。
- [ ] 2.1.3 交互逻辑

  - **敌人 vs 玩家**：碰撞则玩家死亡。
  - **敌人 vs 爆炸**：由于没有分数系统，敌人死后直接移除。

- [ ] 2.1.4 补全通关条件

  - 更新 `CheckLevelCompletion`：必须杀光所有气球才能进门。

- [ ] 2.1.5 (可选) 门被炸惩罚
  - 如果实现了敌人，可以加回“炸门出更多敌人”的惩罚机制。

---

## 推荐开发顺序

1.  **Phase 1**: 实现 `TileDoor`，藏门，炸门现形，进门过关（无敌状态）。
2.  **Phase 2**: 加入 5-6 个气球敌人，实现基本的“别碰我”和“炸死我”逻辑。
